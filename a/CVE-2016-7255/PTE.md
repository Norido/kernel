<h1>PTE<br></h1>Doc này chỉ là cách tiếp cận của tôi về PTE và tóm tắt lại những gì mà tôi cho là cần thiết để EXPLOIT.<br>Trước tiên hay xem qua cách MAP từ&nbsp;Vitural Memory sang Physical Memory.<br><h1>Vitural Memory to Physical Memory<img alt="" src="https://gitlab.visc.com/anlpth/my-awesome-project/raw/9283c2624e8f0d047fcbc401fe59635e171b7f26/CVE-2017-7255/IMG/2.png"></h1>KWEV -&gt; K viết tắt của KERNEL-MOD nghĩa là chỉ có KERNEL mới có quyền ACCESS vào vùng nhớ này.<br>contains 1EB063. Trong đó 1EB000 là nơi chứa pointer đến PAGE LEVEL tiếp theo.<br>Bit 1 = 0. Read-only.<br>Bit 2 = 0. USER-MOD không thể truy cập.<br>Bit 63 = 1. Non Executable<br><h1>Where is PXE, PPE, PDE, PTE</h1><div><div>UINT	PML4_SELF_REF_INDEX;</div><div>UINT64	PML4_SELF_REF = 0xFFFFF6FB7DBEDF68;</div><div>#define GET_INDEX(va) &nbsp;( ((va &gt;&gt; 39) &amp; 0x1ff ))&nbsp;<br><br></div>UINT64 get_pxe_address(UINT64 address) {</div><div>	UINT entry = PML4_SELF_REF_INDEX;</div><div>	UINT64 result = address &gt;&gt; 9;</div><div>	UINT64 lower_boundary = ((UINT64)0xFFFF &lt;&lt; 48) | ((UINT64)entry &lt;&lt; 39);</div><div>	UINT64 upper_boundary = (((UINT64)0xFFFF &lt;&lt; 48) | ((UINT64)entry &lt;&lt; 39) + 0x8000000000 - 1) &amp; 0xFFFFFFFFFFFFFFF8;</div><div>	//printf ("%llx\n %llx\n", lower_boundary, upper_boundary);</div><div>	result = result | lower_boundary;</div><div>	result = result &amp; upper_boundary;</div><div>	return result;</div><div>}<br><br><div>	UINT64 pte = get_pxe_address(ADDR);</div><div>	UINT64 pde = get_pxe_address(pte);</div><div>	UINT64 ppe = get_pxe_address(pde);</div><div>	UINT64 pxe = get_pxe_address(ppe);<br></div></div>